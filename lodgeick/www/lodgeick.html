<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Initialize window.frappe BEFORE any scripts load (including Vite client) -->
    <!-- This prevents "Cannot read properties of undefined" errors from frappe-ui -->
    <script>
      // Complete Frappe Framework shim for standalone frappe-ui
      window.frappe = {
        _messages: {},
        boot: { lang: 'en', sysdefaults: {}, user: {} },
        csrf_token: null,
        datetime: {},
        form: {},
        listview_settings: {},
        model: {
          docinfo: {},
          get_docinfo: function() { return {} },
          get_value: function() { return Promise.resolve() },
          set_value: function() { return Promise.resolve() },
        },
        pages: {},
        provide: function() {},
        require: function() { return Promise.resolve() },
        route_options: null,
        templates: {},
        ui: {
          ScriptManager: function() {
            this.load = function() { return Promise.resolve() }
            this.loaded = {}
          },
          FieldGroup: function() {},
          Dialog: function() {},
          form_builders: {},
          toolbar: {},
        },
        utils: {
          get_url_arg: function() { return null },
          get_query_params: function() { return {} },
        },
        call: function() { return Promise.resolve({ message: {} }) },
        xcall: function() { return Promise.resolve() },
        db: {
          get_value: function() { return Promise.resolve() },
          get_list: function() { return Promise.resolve([]) },
        },
      }
      window.site_name = 'lodgeick.com'
      window.cur_frm = null
      window.cur_list = null
      window.cur_dialog = null
    </script>

    <meta charset="UTF-8" />
    <link rel="icon" href="/assets/lodgeick/frontend/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lodgeick - One-Click Integrations</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <link rel="stylesheet" crossorigin href="/assets/lodgeick/frontend/assets/index-B6-IpI5o.css">
  </head>
  <body>
    <div id="app"></div>
  
    <script>
      // Initialize minimal frappe object to prevent ReferenceErrors
      // This allows the Vue SPA to work while /desk and /app get the real Frappe framework
      if (!window.frappe) {
        window.frappe = {
          session: { user: '{{ user if user else "Guest" }}' },
          csrf_token: '{{ csrf_token if csrf_token else "" }}',
          boot: {
            lang: 'en',
            sysdefaults: {},
            user: '{{ user if user else "Guest" }}',
            user_roles: []
          },
          form: {},
          ui: {
            ScriptManager: function() {
              this.load = function() { return Promise.resolve() }
              this.loaded = {}
            }
          },
          call: function() { return Promise.resolve({ message: {} }) },
          xcall: function() { return Promise.resolve() },
        };
      }

      // Set additional globals
      window.site_name = '{{ site_name if site_name else "localhost" }}';
      window.csrf_token = '{{ csrf_token if csrf_token else "" }}';
      window.cur_frm = null;

      // Frappe boot data
      {% for key in boot %}
      window["{{ key }}"] = {{ boot[key] | tojson }};
      {% endfor %}
    </script>

    <!-- Vue app module loads after frappe globals are set -->
    <script type="module" crossorigin src="/assets/lodgeick/frontend/assets/index-DkgKAo6J.js"></script>
  </body>
</html>
