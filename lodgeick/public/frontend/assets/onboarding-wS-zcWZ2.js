var h=(t,i,c)=>new Promise((g,l)=>{var f=a=>{try{o(c.next(a))}catch(n){l(n)}},d=a=>{try{o(c.throw(a))}catch(n){l(n)}},o=a=>a.done?g(a.value):Promise.resolve(a.value).then(f,d);o((c=c.apply(t,i)).next())});import{G as N,k as v,l as y}from"./index-BRa8Y8OH.js";function F(g,l){return h(this,arguments,function*(t,i,c={}){i||(i={});let f=Object.assign({Accept:"application/json","Content-Type":"application/json; charset=utf-8","X-Frappe-Site-Name":window.location.hostname},c.headers||{});window.csrf_token&&window.csrf_token!=="{{ csrf_token }}"&&(f["X-Frappe-CSRF-Token"]=window.csrf_token);let d=t.startsWith("/")?t:`/api/method/${t}`;const o=yield fetch(d,{method:"POST",headers:f,body:JSON.stringify(i)});if(o.ok){const a=yield o.json();if(a.docs||t==="login")return a;if(a.exc)try{console.groupCollapsed(t),console.log(`method: ${t}`),console.log("params:",i);let n=JSON.parse(a.exc);for(let p of n)console.log(p);console.groupEnd()}catch(n){console.warn("Error printing debug messages",n)}return a.message}else{let a=yield o.text(),n,p;try{n=JSON.parse(a)}catch(m){}let _=[[t,n.exc_type,n._error_message].filter(Boolean).join(" ")];if(n.exc){p=n.exc;try{p=JSON.parse(p)[0],console.log(p)}catch(m){}}let r=new Error(_.join(`
`));throw r.exc_type=n.exc_type,r.exc=p,r.status=o.status,r.messages=n._server_messages?JSON.parse(n._server_messages):[],r.messages=r.messages.concat(n.message),r.messages=r.messages.map(m=>{try{return JSON.parse(m).message}catch(b){return m}}),r.messages=r.messages.filter(Boolean),r.messages.length||(r.messages=n._error_message?[n._error_message]:["Internal Server Error"]),c.onError&&c.onError({response:o,status:o.status,error:r}),r}})}const P=N("onboarding",()=>{const t=v(1),i=v(4),c=v(!1),g=v([]),l=v([]),f=v({}),d=v(!1),o=v([]),a=y(()=>t.value/i.value*100),n=y(()=>{switch(t.value){case 1:return!0;case 2:return g.value.length>0;case 3:return l.value.length>0;case 4:return!0;default:return!1}}),p=y(()=>g.value.length>0);function _(){return h(this,null,function*(){if(!(o.value.length>0)){d.value=!0;try{const e=yield F("lodgeick.api.catalog.get_app_catalog");e.success&&e.apps&&(o.value=e.apps.map(s=>({id:s.app_name,name:s.display_name||s.app_name,description:s.description,icon:r(s.app_name),color:m(s.category),logo_url:s.logo_url,category:s.category,oauth_provider:s.oauth_provider,isConnected:!1,use_cases:s.use_cases||[]})))}catch(e){console.error("Failed to load apps:",e)}finally{d.value=!1}}})}function r(e){return{jira:"🎯",slack:"💬",hubspot:"🎨",google_sheets:"📊",salesforce:"☁️",mailchimp:"✉️",xero:"💼"}[e]||"🔌"}function m(e){return{CRM:"bg-orange-500",Communication:"bg-purple-500",Productivity:"bg-green-500",Finance:"bg-blue-600",Marketing:"bg-yellow-500","Project Management":"bg-blue-500"}[e]||"bg-gray-500"}function b(e){t.value=e}function w(){t.value<i.value&&t.value++}function S(){t.value>1&&t.value--}function x(e){const s=o.value.find(u=>u.id===e);s&&!s.isConnected&&(s.isConnected=!0,g.value.push(e))}function C(e){const s=o.value.find(u=>u.id===e);s&&(s.isConnected=!1,g.value=g.value.filter(u=>u!==e),l.value=l.value.filter(u=>!u.includes(e)))}function O(e,s){const u=`${e}-${s}`;l.value.includes(u)||l.value.push(u)}function k(e){l.value=l.value.filter(s=>s!==e)}function A(e,s){f.value[e]=s}function j(){c.value=!0,t.value=1}function E(){t.value=1,c.value=!1,g.value=[],l.value=[],f.value={},o.value.forEach(e=>{e.isConnected=!1})}return{currentStep:t,totalSteps:i,isCompleted:c,connectedApps:g,selectedIntegrations:l,fieldMappings:f,availableApps:o,isLoadingApps:d,progress:a,canContinue:n,hasConnectedApps:p,loadApps:_,setStep:b,nextStep:w,previousStep:S,connectApp:x,disconnectApp:C,addIntegration:O,removeIntegration:k,saveFieldMapping:A,completeOnboarding:j,resetOnboarding:E}});export{P as u};
//# sourceMappingURL=onboarding-wS-zcWZ2.js.map
