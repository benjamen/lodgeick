{"version":3,"file":"IntegrateView-lIdv0lSJ.js","sources":["../../../../frontend/src/components/OAuthSetupWizard.vue","../../../../frontend/src/pages/onboarding/IntegrateView.vue"],"sourcesContent":["<template>\r\n  <div\r\n    class=\"modal fade\"\r\n    :class=\"{ show: show, 'd-block': show }\"\r\n    tabindex=\"-1\"\r\n    :style=\"{ backgroundColor: show ? 'rgba(0,0,0,0.5)' : '' }\"\r\n    @click.self=\"closeWizard\"\r\n  >\r\n    <div class=\"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable\">\r\n      <div class=\"modal-content\">\r\n        <!-- Header -->\r\n        <div class=\"modal-header bg-gradient-primary\">\r\n          <h5 class=\"modal-title text-white font-weight-bold\">\r\n            <i class=\"fas fa-magic me-2\"></i>\r\n            OAuth Setup Wizard - {{ providerName }}\r\n          </h5>\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn-close btn-close-white\"\r\n            @click=\"closeWizard\"\r\n          ></button>\r\n        </div>\r\n\r\n        <!-- Body -->\r\n        <div class=\"modal-body p-4\">\r\n          <!-- Progress Steps -->\r\n          <div class=\"row mb-4\">\r\n            <div class=\"col-12\">\r\n              <div class=\"d-flex justify-content-between align-items-center\">\r\n                <div\r\n                  v-for=\"(step, index) in steps\"\r\n                  :key=\"index\"\r\n                  class=\"flex-fill text-center position-relative\"\r\n                >\r\n                  <div\r\n                    class=\"step-circle mx-auto mb-2\"\r\n                    :class=\"{\r\n                      'active': currentStep === index,\r\n                      'completed': currentStep > index\r\n                    }\"\r\n                  >\r\n                    <i v-if=\"currentStep > index\" class=\"fas fa-check\"></i>\r\n                    <span v-else>{{ index + 1 }}</span>\r\n                  </div>\r\n                  <small class=\"d-block text-muted\">{{ step.title }}</small>\r\n                  <div\r\n                    v-if=\"index < steps.length - 1\"\r\n                    class=\"step-line\"\r\n                    :class=\"{ 'completed': currentStep > index }\"\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Step Content -->\r\n          <div class=\"step-content\">\r\n            <!-- Step 0: Create Google Cloud Project -->\r\n            <div v-if=\"currentStep === 0\" class=\"step\">\r\n              <h5 class=\"font-weight-bold mb-3\">\r\n                <i class=\"fab fa-google text-primary me-2\"></i>\r\n                Create Google Cloud Project\r\n              </h5>\r\n              <div class=\"alert alert-info\">\r\n                <i class=\"fas fa-info-circle me-2\"></i>\r\n                You'll need a Google account to create a Cloud project.\r\n              </div>\r\n              <ol class=\"setup-steps\">\r\n                <li class=\"mb-3\">\r\n                  Go to <a href=\"https://console.cloud.google.com\" target=\"_blank\" class=\"text-primary\">\r\n                    <strong>Google Cloud Console</strong>\r\n                    <i class=\"fas fa-external-link-alt ms-1 small\"></i>\r\n                  </a>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click the project dropdown at the top\r\n                  <br><small class=\"text-muted\">It usually says \"Select a project\" or shows your current project</small>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"New Project\"</strong> in the top right\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Name your project (e.g., \"Lodgeick Integration\")\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Create\"</strong> and wait for the project to be created\r\n                </li>\r\n              </ol>\r\n              <div class=\"text-center mt-4\">\r\n                <img\r\n                  src=\"https://cloud.google.com/static/images/social-icon-google-cloud-1200-630.png\"\r\n                  alt=\"Google Cloud\"\r\n                  class=\"img-fluid rounded shadow\"\r\n                  style=\"max-height: 200px;\"\r\n                >\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Step 1: Enable APIs -->\r\n            <div v-if=\"currentStep === 1\" class=\"step\">\r\n              <h5 class=\"font-weight-bold mb-3\">\r\n                <i class=\"fas fa-toggle-on text-success me-2\"></i>\r\n                Enable Required APIs\r\n              </h5>\r\n              <div class=\"alert alert-warning\">\r\n                <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n                Make sure your new project is selected in the project dropdown!\r\n              </div>\r\n              <ol class=\"setup-steps\">\r\n                <li class=\"mb-3\">\r\n                  Go to <a href=\"https://console.cloud.google.com/apis/library\" target=\"_blank\" class=\"text-primary\">\r\n                    <strong>APIs & Services > Library</strong>\r\n                    <i class=\"fas fa-external-link-alt ms-1 small\"></i>\r\n                  </a>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Search for and enable these APIs:\r\n                  <div class=\"mt-2\">\r\n                    <span class=\"badge bg-gradient-primary me-2 mb-2\">Gmail API</span>\r\n                    <span class=\"badge bg-gradient-info me-2 mb-2\">Google Sheets API</span>\r\n                    <span class=\"badge bg-gradient-success me-2 mb-2\">Google Drive API</span>\r\n                  </div>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  For each API:\r\n                  <ul class=\"mt-2\">\r\n                    <li>Click on the API name</li>\r\n                    <li>Click the blue <strong>\"Enable\"</strong> button</li>\r\n                    <li>Wait for it to activate (takes a few seconds)</li>\r\n                  </ul>\r\n                </li>\r\n              </ol>\r\n            </div>\r\n\r\n            <!-- Step 2: Configure OAuth Consent Screen -->\r\n            <div v-if=\"currentStep === 2\" class=\"step\">\r\n              <h5 class=\"font-weight-bold mb-3\">\r\n                <i class=\"fas fa-shield-alt text-warning me-2\"></i>\r\n                Configure OAuth Consent Screen\r\n              </h5>\r\n              <ol class=\"setup-steps\">\r\n                <li class=\"mb-3\">\r\n                  Go to <a href=\"https://console.cloud.google.com/apis/credentials/consent\" target=\"_blank\" class=\"text-primary\">\r\n                    <strong>APIs & Services > OAuth consent screen</strong>\r\n                    <i class=\"fas fa-external-link-alt ms-1 small\"></i>\r\n                  </a>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Select <strong>\"External\"</strong> user type\r\n                  <br><small class=\"text-muted\">This allows you to use any Google account for testing</small>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Create\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Fill in the required fields:\r\n                  <div class=\"card mt-2 bg-light\">\r\n                    <div class=\"card-body\">\r\n                      <div class=\"mb-2\"><strong>App name:</strong> Lodgeick</div>\r\n                      <div class=\"mb-2\"><strong>User support email:</strong> Your email</div>\r\n                      <div class=\"mb-2\"><strong>Developer contact:</strong> Your email</div>\r\n                    </div>\r\n                  </div>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Save and Continue\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  On the \"Scopes\" page, click <strong>\"Add or Remove Scopes\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Search for and select these scopes:\r\n                  <div class=\"card mt-2 bg-light\">\r\n                    <div class=\"card-body small\">\r\n                      <div class=\"mb-1\"><code>https://www.googleapis.com/auth/gmail.readonly</code></div>\r\n                      <div class=\"mb-1\"><code>https://www.googleapis.com/auth/gmail.send</code></div>\r\n                      <div class=\"mb-1\"><code>https://www.googleapis.com/auth/spreadsheets</code></div>\r\n                      <div class=\"mb-1\"><code>https://www.googleapis.com/auth/drive.file</code></div>\r\n                    </div>\r\n                  </div>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Update\"</strong> then <strong>\"Save and Continue\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  On the \"Test users\" page, click <strong>\"Add Users\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Add your Gmail address (the one you'll test with)\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Save and Continue\"</strong> through the remaining steps\r\n                </li>\r\n              </ol>\r\n            </div>\r\n\r\n            <!-- Step 3: Create OAuth Credentials -->\r\n            <div v-if=\"currentStep === 3\" class=\"step\">\r\n              <h5 class=\"font-weight-bold mb-3\">\r\n                <i class=\"fas fa-key text-danger me-2\"></i>\r\n                Create OAuth 2.0 Credentials\r\n              </h5>\r\n              <ol class=\"setup-steps\">\r\n                <li class=\"mb-3\">\r\n                  Go to <a href=\"https://console.cloud.google.com/apis/credentials\" target=\"_blank\" class=\"text-primary\">\r\n                    <strong>APIs & Services > Credentials</strong>\r\n                    <i class=\"fas fa-external-link-alt ms-1 small\"></i>\r\n                  </a>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Create Credentials\"</strong> at the top\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Select <strong>\"OAuth 2.0 Client ID\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Application type: <strong>\"Web application\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Name: <strong>\"Lodgeick Local\"</strong> (or any name you prefer)\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Under <strong>\"Authorized redirect URIs\"</strong>, click <strong>\"Add URI\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Add this exact URI:\r\n                  <div class=\"input-group mt-2\">\r\n                    <input\r\n                      type=\"text\"\r\n                      class=\"form-control\"\r\n                      :value=\"redirectUri\"\r\n                      readonly\r\n                    >\r\n                    <button\r\n                      class=\"btn btn-outline-secondary\"\r\n                      @click=\"copyToClipboard(redirectUri)\"\r\n                    >\r\n                      <i class=\"fas fa-copy\"></i>\r\n                    </button>\r\n                  </div>\r\n                  <small class=\"text-muted\">Click the copy button to copy the URI</small>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  Click <strong>\"Create\"</strong>\r\n                </li>\r\n                <li class=\"mb-3\">\r\n                  A dialog will appear showing your credentials\r\n                  <div class=\"alert alert-warning mt-2\">\r\n                    <i class=\"fas fa-exclamation-triangle me-2\"></i>\r\n                    <strong>Important:</strong> Copy both the Client ID and Client Secret - you'll need them in the next step!\r\n                  </div>\r\n                </li>\r\n              </ol>\r\n            </div>\r\n\r\n            <!-- Step 4: Configure Lodgeick -->\r\n            <div v-if=\"currentStep === 4\" class=\"step\">\r\n              <h5 class=\"font-weight-bold mb-3\">\r\n                <i class=\"fas fa-cog text-info me-2\"></i>\r\n                Configure Lodgeick\r\n              </h5>\r\n              <p>Enter your OAuth credentials from Google Cloud Console:</p>\r\n\r\n              <div class=\"mb-3\">\r\n                <label class=\"form-label font-weight-bold\">\r\n                  Client ID\r\n                  <span class=\"text-danger\">*</span>\r\n                </label>\r\n                <input\r\n                  v-model=\"clientId\"\r\n                  type=\"text\"\r\n                  class=\"form-control\"\r\n                  placeholder=\"1234567890-abc123def456.apps.googleusercontent.com\"\r\n                >\r\n                <small class=\"text-muted\">\r\n                  Ends with .apps.googleusercontent.com\r\n                </small>\r\n              </div>\r\n\r\n              <div class=\"mb-3\">\r\n                <label class=\"form-label font-weight-bold\">\r\n                  Client Secret\r\n                  <span class=\"text-danger\">*</span>\r\n                </label>\r\n                <div class=\"input-group\">\r\n                  <input\r\n                    v-model=\"clientSecret\"\r\n                    :type=\"showSecret ? 'text' : 'password'\"\r\n                    class=\"form-control\"\r\n                    placeholder=\"GOCSPX-xxxxxxxxxxxxx\"\r\n                  >\r\n                  <button\r\n                    class=\"btn btn-outline-secondary\"\r\n                    @click=\"showSecret = !showSecret\"\r\n                  >\r\n                    <i :class=\"showSecret ? 'fas fa-eye-slash' : 'fas fa-eye'\"></i>\r\n                  </button>\r\n                </div>\r\n                <small class=\"text-muted\">\r\n                  Usually starts with GOCSPX-\r\n                </small>\r\n              </div>\r\n\r\n              <div class=\"alert alert-success\" v-if=\"clientId && clientSecret\">\r\n                <i class=\"fas fa-check-circle me-2\"></i>\r\n                Credentials look good! Click \"Save & Test Connection\" to finish.\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Step 5: Complete -->\r\n            <div v-if=\"currentStep === 5\" class=\"step text-center\">\r\n              <div class=\"icon icon-shape bg-gradient-success shadow-success mx-auto mb-4\" style=\"width: 80px; height: 80px;\">\r\n                <i class=\"fas fa-check text-white\" style=\"font-size: 2.5rem;\"></i>\r\n              </div>\r\n              <h4 class=\"font-weight-bold mb-3\">Setup Complete!</h4>\r\n              <p class=\"text-muted mb-4\">\r\n                Your OAuth credentials have been configured successfully.\r\n              </p>\r\n              <div class=\"alert alert-info\">\r\n                <i class=\"fas fa-lightbulb me-2\"></i>\r\n                You can now close this wizard and click \"Connect App\" to authenticate with {{ providerName }}.\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Footer -->\r\n        <div class=\"modal-footer\">\r\n          <button\r\n            v-if=\"currentStep > 0 && currentStep < 5\"\r\n            type=\"button\"\r\n            class=\"btn btn-secondary\"\r\n            @click=\"previousStep\"\r\n          >\r\n            <i class=\"fas fa-arrow-left me-2\"></i>\r\n            Previous\r\n          </button>\r\n          <button\r\n            v-if=\"currentStep < 4\"\r\n            type=\"button\"\r\n            class=\"btn btn-primary\"\r\n            @click=\"nextStep\"\r\n          >\r\n            Next\r\n            <i class=\"fas fa-arrow-right ms-2\"></i>\r\n          </button>\r\n          <button\r\n            v-if=\"currentStep === 4\"\r\n            type=\"button\"\r\n            class=\"btn btn-success\"\r\n            @click=\"saveCredentials\"\r\n            :disabled=\"!clientId || !clientSecret || saving\"\r\n          >\r\n            <span v-if=\"saving\">\r\n              <span class=\"spinner-border spinner-border-sm me-2\"></span>\r\n              Saving...\r\n            </span>\r\n            <span v-else>\r\n              <i class=\"fas fa-save me-2\"></i>\r\n              Save & Test Connection\r\n            </span>\r\n          </button>\r\n          <button\r\n            v-if=\"currentStep === 5\"\r\n            type=\"button\"\r\n            class=\"btn btn-primary\"\r\n            @click=\"closeWizard\"\r\n          >\r\n            <i class=\"fas fa-check me-2\"></i>\r\n            Done\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\"\r\nimport { createResource } from \"frappe-ui\"\r\n\r\nconst props = defineProps({\r\n  show: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  provider: {\r\n    type: String,\r\n    required: true\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['close', 'success'])\r\n\r\nconst currentStep = ref(0)\r\nconst clientId = ref('')\r\nconst clientSecret = ref('')\r\nconst showSecret = ref(false)\r\nconst saving = ref(false)\r\n\r\nconst providerName = computed(() => {\r\n  const names = {\r\n    google: 'Google (Gmail, Sheets, Drive)',\r\n    xero: 'Xero',\r\n    slack: 'Slack'\r\n  }\r\n  return names[props.provider] || props.provider\r\n})\r\n\r\nconst redirectUri = computed(() => {\r\n  return window.location.origin + '/oauth/callback'\r\n})\r\n\r\nconst steps = [\r\n  { title: 'Create Project' },\r\n  { title: 'Enable APIs' },\r\n  { title: 'Consent Screen' },\r\n  { title: 'Create Credentials' },\r\n  { title: 'Configure' },\r\n  { title: 'Complete' }\r\n]\r\n\r\n// Save credentials resource\r\nconst saveCredentialsResource = createResource({\r\n  url: \"lodgeick.api.oauth.save_oauth_credentials\",\r\n  makeParams() {\r\n    return {\r\n      provider: props.provider,\r\n      client_id: clientId.value,\r\n      client_secret: clientSecret.value\r\n    }\r\n  },\r\n  onSuccess() {\r\n    saving.value = false\r\n    currentStep.value = 5\r\n    emit('success', {\r\n      provider: props.provider,\r\n      client_id: clientId.value,\r\n      client_secret: clientSecret.value\r\n    })\r\n  },\r\n  onError(error) {\r\n    saving.value = false\r\n    alert(`Failed to save credentials: ${error.message || error}`)\r\n  }\r\n})\r\n\r\nfunction nextStep() {\r\n  if (currentStep.value < steps.length - 1) {\r\n    currentStep.value++\r\n  }\r\n}\r\n\r\nfunction previousStep() {\r\n  if (currentStep.value > 0) {\r\n    currentStep.value--\r\n  }\r\n}\r\n\r\nfunction saveCredentials() {\r\n  if (!clientId.value || !clientSecret.value) {\r\n    alert('Please enter both Client ID and Client Secret')\r\n    return\r\n  }\r\n\r\n  saving.value = true\r\n  saveCredentialsResource.submit()\r\n}\r\n\r\nfunction copyToClipboard(text) {\r\n  navigator.clipboard.writeText(text).then(() => {\r\n    // Show toast or temporary message\r\n    const button = event.target.closest('button')\r\n    const icon = button.querySelector('i')\r\n    icon.className = 'fas fa-check'\r\n    setTimeout(() => {\r\n      icon.className = 'fas fa-copy'\r\n    }, 2000)\r\n  })\r\n}\r\n\r\nfunction closeWizard() {\r\n  currentStep.value = 0\r\n  clientId.value = ''\r\n  clientSecret.value = ''\r\n  showSecret.value = false\r\n  emit('close')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.step-circle {\r\n  width: 48px;\r\n  height: 48px;\r\n  border-radius: 50%;\r\n  background: #e9ecef;\r\n  color: #6c757d;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-weight: bold;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.step-circle.active {\r\n  background: linear-gradient(310deg, #7928CA 0%, #FF0080 100%);\r\n  color: white;\r\n  box-shadow: 0 4px 20px 0 rgba(121, 40, 202, 0.4);\r\n}\r\n\r\n.step-circle.completed {\r\n  background: linear-gradient(310deg, #17AD37 0%, #98EC2D 100%);\r\n  color: white;\r\n}\r\n\r\n.step-line {\r\n  position: absolute;\r\n  top: 24px;\r\n  left: 50%;\r\n  width: 100%;\r\n  height: 2px;\r\n  background: #e9ecef;\r\n  z-index: -1;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.step-line.completed {\r\n  background: linear-gradient(310deg, #17AD37 0%, #98EC2D 100%);\r\n}\r\n\r\n.setup-steps {\r\n  padding-left: 1.5rem;\r\n}\r\n\r\n.setup-steps li {\r\n  line-height: 1.8;\r\n}\r\n\r\n.bg-gradient-primary {\r\n  background: linear-gradient(310deg, #7928CA 0%, #FF0080 100%);\r\n}\r\n\r\n.bg-gradient-success {\r\n  background: linear-gradient(310deg, #17AD37 0%, #98EC2D 100%);\r\n}\r\n\r\n.shadow-success {\r\n  box-shadow: 0 4px 20px 0 rgba(23, 173, 55, 0.4) !important;\r\n}\r\n\r\n.icon-shape {\r\n  border-radius: 0.75rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.font-weight-bold {\r\n  font-weight: 700;\r\n}\r\n\r\n.modal.show {\r\n  display: block;\r\n}\r\n\r\n.modal-dialog-scrollable .modal-body {\r\n  max-height: calc(100vh - 200px);\r\n  overflow-y: auto;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100\">\r\n    <!-- Header with Logo and Account Menu -->\r\n    <div class=\"p-6\">\r\n      <div class=\"flex items-center justify-between\">\r\n        <router-link to=\"/\" class=\"inline-flex items-center gap-3 group no-underline\">\r\n          <div class=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center\">\r\n            <span class=\"text-white font-bold text-xl\">L</span>\r\n          </div>\r\n          <span class=\"text-2xl font-bold text-gray-900\">Lodgeick</span>\r\n        </router-link>\r\n\r\n        <!-- User Menu -->\r\n        <div class=\"flex items-center gap-4\">\r\n          <router-link\r\n            to=\"/account/profile\"\r\n            class=\"text-gray-700 hover:text-blue-600 font-medium transition-colors no-underline flex items-center gap-2\"\r\n          >\r\n            <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\r\n            </svg>\r\n            My Account\r\n          </router-link>\r\n          <button\r\n            @click=\"handleLogout\"\r\n            class=\"text-gray-700 hover:text-red-600 font-medium transition-colors flex items-center gap-2\"\r\n          >\r\n            <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\r\n            </svg>\r\n            Log Out\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Main Content -->\r\n    <div class=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-12\">\r\n      <!-- Progress Bar -->\r\n      <StepProgressBar :current-step=\"onboardingStore.currentStep\" :total-steps=\"4\" />\r\n\r\n      <!-- Header -->\r\n      <div class=\"text-center mb-12\">\r\n        <h1 class=\"text-4xl font-bold text-gray-900 mb-4\">\r\n          Connect Your Apps\r\n        </h1>\r\n        <p class=\"text-xl text-gray-600 max-w-2xl mx-auto\">\r\n          Set up OAuth credentials and authorize each app to enable seamless integrations\r\n        </p>\r\n      </div>\r\n\r\n      <!-- Apps Grid -->\r\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n        <div\r\n          v-for=\"appId in onboardingStore.connectedApps\"\r\n          :key=\"appId\"\r\n          class=\"bg-white rounded-2xl shadow-lg p-6 transition-all duration-200 hover:shadow-xl\"\r\n        >\r\n          <div class=\"flex items-start justify-between mb-4\">\r\n            <div class=\"flex items-center gap-4\">\r\n              <div\r\n                class=\"w-16 h-16 rounded-lg flex items-center justify-center text-3xl\"\r\n                :class=\"getAppById(appId)?.color\"\r\n              >\r\n                {{ getAppById(appId)?.icon }}\r\n              </div>\r\n              <div>\r\n                <h3 class=\"text-xl font-bold text-gray-900\">\r\n                  {{ getAppById(appId)?.name }}\r\n                </h3>\r\n                <p class=\"text-sm text-gray-500\">\r\n                  {{ getAppById(appId)?.description }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div\r\n              class=\"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center\"\r\n              :class=\"getConnectionStatus(appId) === 'connected' ? 'bg-green-100' : getConnectionStatus(appId) === 'credentials' ? 'bg-yellow-100' : 'bg-gray-100'\"\r\n            >\r\n              <svg\r\n                v-if=\"getConnectionStatus(appId) === 'connected'\"\r\n                class=\"w-5 h-5 text-green-600\"\r\n                fill=\"currentColor\"\r\n                viewBox=\"0 0 20 20\"\r\n              >\r\n                <path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\" />\r\n              </svg>\r\n              <svg\r\n                v-else-if=\"getConnectionStatus(appId) === 'credentials'\"\r\n                class=\"w-5 h-5 text-yellow-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\" />\r\n              </svg>\r\n              <svg\r\n                v-else\r\n                class=\"w-5 h-5 text-gray-400\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n              </svg>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Connection Steps -->\r\n          <div class=\"space-y-3\">\r\n            <!-- Step 1: Set up OAuth Credentials -->\r\n            <div class=\"flex items-center gap-3\">\r\n              <div\r\n                class=\"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold\"\r\n                :class=\"hasCredentials(appId) ? 'bg-green-500 text-white' : 'bg-gray-300 text-gray-700'\"\r\n              >\r\n                {{ hasCredentials(appId) ? '✓' : '1' }}\r\n              </div>\r\n              <div class=\"flex-1\">\r\n                <p class=\"text-sm font-medium text-gray-900\">\r\n                  OAuth Credentials\r\n                </p>\r\n                <button\r\n                  v-if=\"!hasCredentials(appId)\"\r\n                  @click=\"openWizard(appId)\"\r\n                  class=\"text-xs text-blue-600 hover:text-blue-700 font-medium\"\r\n                >\r\n                  Set up credentials →\r\n                </button>\r\n                <p v-else class=\"text-xs text-green-600\">\r\n                  Configured\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Step 2: Authorize -->\r\n            <div class=\"flex items-center gap-3\">\r\n              <div\r\n                class=\"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold\"\r\n                :class=\"isAuthorized(appId) ? 'bg-green-500 text-white' : hasCredentials(appId) ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-700'\"\r\n              >\r\n                {{ isAuthorized(appId) ? '✓' : '2' }}\r\n              </div>\r\n              <div class=\"flex-1\">\r\n                <p class=\"text-sm font-medium text-gray-900\">\r\n                  Authorize Access\r\n                </p>\r\n                <button\r\n                  v-if=\"hasCredentials(appId) && !isAuthorized(appId)\"\r\n                  @click=\"authorizeApp(appId)\"\r\n                  :disabled=\"authorizingApp === appId\"\r\n                  class=\"text-xs text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50\"\r\n                >\r\n                  {{ authorizingApp === appId ? 'Authorizing...' : 'Authorize now →' }}\r\n                </button>\r\n                <p v-else-if=\"isAuthorized(appId)\" class=\"text-xs text-green-600\">\r\n                  Authorized\r\n                </p>\r\n                <p v-else class=\"text-xs text-gray-500\">\r\n                  Complete step 1 first\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Step 3: Test Connection -->\r\n            <div class=\"flex items-center gap-3\">\r\n              <div\r\n                class=\"flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold\"\r\n                :class=\"connectionTested[appId] ? 'bg-green-500 text-white' : isAuthorized(appId) ? 'bg-blue-500 text-white' : 'bg-gray-300 text-gray-700'\"\r\n              >\r\n                {{ connectionTested[appId] ? '✓' : '3' }}\r\n              </div>\r\n              <div class=\"flex-1\">\r\n                <p class=\"text-sm font-medium text-gray-900\">\r\n                  Test Connection\r\n                </p>\r\n                <button\r\n                  v-if=\"isAuthorized(appId) && !connectionTested[appId]\"\r\n                  @click=\"testConnection(appId)\"\r\n                  :disabled=\"testingConnection === appId\"\r\n                  class=\"text-xs text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50\"\r\n                >\r\n                  {{ testingConnection === appId ? 'Testing...' : 'Test now →' }}\r\n                </button>\r\n                <p v-else-if=\"connectionTested[appId]\" class=\"text-xs text-green-600\">\r\n                  Connection verified\r\n                </p>\r\n                <p v-else class=\"text-xs text-gray-500\">\r\n                  Complete step 2 first\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Action Buttons -->\r\n      <div class=\"flex justify-between items-center\">\r\n        <SecondaryButton\r\n          label=\"Back\"\r\n          @click=\"goBack\"\r\n        >\r\n          <template #icon>\r\n            <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n          </template>\r\n        </SecondaryButton>\r\n\r\n        <div class=\"flex gap-3\">\r\n          <SecondaryButton\r\n            label=\"Skip for Now\"\r\n            @click=\"skipToCompletion\"\r\n          />\r\n\r\n          <PrimaryButton\r\n            label=\"Continue\"\r\n            :disabled=\"!allAppsConnected\"\r\n            @click=\"nextStep\"\r\n          >\r\n            <template #iconRight>\r\n              <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\" />\r\n              </svg>\r\n            </template>\r\n          </PrimaryButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- OAuth Setup Wizard Modal -->\r\n    <OAuthSetupWizard\r\n      :show=\"wizardVisible\"\r\n      :provider=\"selectedProvider\"\r\n      @close=\"wizardVisible = false\"\r\n      @success=\"handleCredentialsSaved\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { createResource } from 'frappe-ui'\r\nimport { session } from '@/data/session'\r\nimport { useOnboardingStore } from '@/stores/onboarding'\r\nimport StepProgressBar from '@/components/onboarding/StepProgressBar.vue'\r\nimport PrimaryButton from '@/components/onboarding/PrimaryButton.vue'\r\nimport SecondaryButton from '@/components/onboarding/SecondaryButton.vue'\r\nimport OAuthSetupWizard from '@/components/OAuthSetupWizard.vue'\r\n\r\nconst router = useRouter()\r\nconst onboardingStore = useOnboardingStore()\r\n\r\nconst handleLogout = () => {\r\n  session.logout.submit()\r\n}\r\n\r\n// State\r\nconst wizardVisible = ref(false)\r\nconst selectedProvider = ref('')\r\nconst authorizingApp = ref(null)\r\nconst testingConnection = ref(null)\r\nconst connectionTested = ref({})\r\nconst appCredentials = ref({}) // Track which apps have credentials\r\nconst appTokens = ref({}) // Track which apps have tokens\r\n\r\n// Get app by ID\r\nconst getAppById = (appId) => {\r\n  return onboardingStore.availableApps.find(app => app.id === appId)\r\n}\r\n\r\n// Check if app has credentials\r\nconst hasCredentials = (appId) => {\r\n  return appCredentials.value[appId] === true\r\n}\r\n\r\n// Check if app is authorized (has token)\r\nconst isAuthorized = (appId) => {\r\n  return appTokens.value[appId] === true\r\n}\r\n\r\n// Get connection status\r\nconst getConnectionStatus = (appId) => {\r\n  if (isAuthorized(appId) && connectionTested.value[appId]) {\r\n    return 'connected'\r\n  } else if (hasCredentials(appId)) {\r\n    return 'credentials'\r\n  }\r\n  return 'not-connected'\r\n}\r\n\r\n// Check if all apps are connected\r\nconst allAppsConnected = computed(() => {\r\n  return onboardingStore.connectedApps.every(appId =>\r\n    isAuthorized(appId) && connectionTested.value[appId]\r\n  )\r\n})\r\n\r\n// Open OAuth wizard for an app\r\nconst openWizard = (appId) => {\r\n  const app = getAppById(appId)\r\n  if (app) {\r\n    selectedProvider.value = app.oauth_provider || appId\r\n    wizardVisible.value = true\r\n  }\r\n}\r\n\r\n// Handle credentials saved\r\nconst handleCredentialsSaved = (data) => {\r\n  wizardVisible.value = false\r\n  // Mark credentials as saved for this provider\r\n  const appId = onboardingStore.connectedApps.find(id => {\r\n    const app = getAppById(id)\r\n    return app && (app.oauth_provider === data.provider || app.id === data.provider)\r\n  })\r\n  if (appId) {\r\n    appCredentials.value[appId] = true\r\n  }\r\n}\r\n\r\n// Authorize app - initiate OAuth flow\r\nconst authorizeApp = async (appId) => {\r\n  const app = getAppById(appId)\r\n  if (!app) return\r\n\r\n  authorizingApp.value = appId\r\n  const provider = app.oauth_provider || appId\r\n\r\n  try {\r\n    const response = await initiateOAuthResource.submit({ provider })\r\n    if (response.success && response.authorization_url) {\r\n      // Redirect to OAuth provider\r\n      window.location.href = response.authorization_url\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to initiate OAuth:', error)\r\n    alert('Failed to start authorization. Please check your credentials.')\r\n  } finally {\r\n    authorizingApp.value = null\r\n  }\r\n}\r\n\r\n// Test connection\r\nconst testConnection = async (appId) => {\r\n  const app = getAppById(appId)\r\n  if (!app) return\r\n\r\n  testingConnection.value = appId\r\n  const provider = app.oauth_provider || appId\r\n\r\n  try {\r\n    // Simulate connection test (replace with actual API call)\r\n    await new Promise(resolve => setTimeout(resolve, 1500))\r\n    connectionTested.value[appId] = true\r\n\r\n    // In a real implementation, you would call an API like:\r\n    // const response = await testConnectionResource.submit({ provider })\r\n    // connectionTested.value[appId] = response.success\r\n  } catch (error) {\r\n    console.error('Connection test failed:', error)\r\n    alert('Connection test failed. Please try authorizing again.')\r\n  } finally {\r\n    testingConnection.value = null\r\n  }\r\n}\r\n\r\n// Initiate OAuth resource\r\nconst initiateOAuthResource = createResource({\r\n  url: 'lodgeick.api.oauth.initiate_oauth',\r\n  makeParams(values) {\r\n    return {\r\n      provider: values.provider,\r\n      redirect_uri: window.location.origin + '/oauth/callback'\r\n    }\r\n  }\r\n})\r\n\r\n// Navigation\r\nconst nextStep = () => {\r\n  onboardingStore.nextStep()\r\n  router.push({ name: 'Configure' })\r\n}\r\n\r\nconst skipToCompletion = () => {\r\n  onboardingStore.completeOnboarding()\r\n  router.push({ name: 'Dashboard' })\r\n}\r\n\r\nconst goBack = () => {\r\n  onboardingStore.previousStep()\r\n  router.push({ name: 'ConnectApps' })\r\n}\r\n\r\n// Check for OAuth callback on mount\r\nonMounted(() => {\r\n  // If no apps connected, redirect back\r\n  if (onboardingStore.connectedApps.length === 0) {\r\n    router.push({ name: 'ConnectApps' })\r\n    return\r\n  }\r\n\r\n  // Check if returning from OAuth callback\r\n  const urlParams = new URLSearchParams(window.location.search)\r\n  const success = urlParams.get('oauth_success')\r\n  const provider = urlParams.get('provider')\r\n\r\n  if (success === 'true' && provider) {\r\n    // Find the app with this provider\r\n    const appId = onboardingStore.connectedApps.find(id => {\r\n      const app = getAppById(id)\r\n      return app && (app.oauth_provider === provider || app.id === provider)\r\n    })\r\n\r\n    if (appId) {\r\n      appTokens.value[appId] = true\r\n      appCredentials.value[appId] = true\r\n    }\r\n\r\n    // Clean up URL\r\n    window.history.replaceState({}, document.title, window.location.pathname)\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n/* Add any custom styles here */\r\n</style>\r\n"],"names":["props","__props","emit","__emit","currentStep","ref","clientId","clientSecret","showSecret","saving","providerName","computed","redirectUri","steps","saveCredentialsResource","createResource","error","nextStep","previousStep","saveCredentials","copyToClipboard","text","icon","closeWizard","_createElementBlock","_normalizeClass","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_createTextVNode","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_openBlock","_Fragment","_renderList","step","index","_hoisted_9","_hoisted_11","_toDisplayString","_hoisted_12","_hoisted_13","_cache","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","$event","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_31","_hoisted_32","router","useRouter","onboardingStore","useOnboardingStore","handleLogout","session","wizardVisible","selectedProvider","authorizingApp","testingConnection","connectionTested","appCredentials","appTokens","getAppById","appId","app","hasCredentials","isAuthorized","getConnectionStatus","allAppsConnected","openWizard","handleCredentialsSaved","data","id","authorizeApp","__async","provider","response","initiateOAuthResource","testConnection","resolve","values","skipToCompletion","goBack","onMounted","urlParams","success","_createVNode","_component_router_link","StepProgressBar","_unref","_a","_b","_c","_hoisted_10","_d","_hoisted_20","_hoisted_25","SecondaryButton","_hoisted_30","PrimaryButton","OAuthSetupWizard"],"mappings":"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"}